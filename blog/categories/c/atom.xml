<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: c | Code Mind]]></title>
  <link href="http://gekben.gitcd.com/blog/categories/c/atom.xml" rel="self"/>
  <link href="http://gekben.gitcd.com/"/>
  <updated>2012-08-16T21:56:41+08:00</updated>
  <id>http://gekben.gitcd.com/</id>
  <author>
    <name><![CDATA[Kevin Zeng]]></name>
    <email><![CDATA[kevintech08@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[TCP状态迁移及状态码]]></title>
    <link href="http://gekben.gitcd.com/blog/2012/08/09/check-tcp-connections/"/>
    <updated>2012-08-09T11:39:00+08:00</updated>
    <id>http://gekben.gitcd.com/blog/2012/08/09/check-tcp-connections</id>
    <content type="html"><![CDATA[<p>{% imgpopup /images/post_img/Tcp_state_diagram.svg  50%  %}</p>

<p>想必大家对上图都比较熟悉了，补充下内核里对以上状态码的表示，顺便对源代码做了下改动，每个
状态的代码都补出来了。</p>

<p>{% codeblock tcp_state.h lang:c %}</p>

<p>enum {</p>

<pre><code>TCP_ESTABLISHED = 1,
TCP_SYN_SENT    = 2,
TCP_SYN_RECV    = 3,
TCP_FIN_WAIT1   = 4,
TCP_FIN_WAIT2   = 5,
TCP_TIME_WAIT   = 6
TCP_CLOSE       = 7, 
TCP_CLOSE_WAIT  = 8,
TCP_LAST_ACK    = 9,
TCP_LISTEN      = 10,
TCP_CLOSING     = 11,   /* Now a valid state */

TCP_MAX_STATES  /* Leave at the end! */
</code></pre>

<p>};</p>

<p>{% endcodeblock   %}</p>

<!-- more -->


<p>用<code>cat /proc/net/tcp</code>打印时，输出所有active connections，
<a href="%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E4%BB%8B%E7%BB%8D">http://search.cpan.org/~salva/Linux-Proc-Net-TCP-0.03/lib/Linux/Proc/Net/TCP.pm#The_/proc/net/tcp_documentation</a>。</p>

<p><code>st</code>这一列即代表连接状态，下面该怎么做，你懂的。</p>

<p>Have fun.</p>
]]></content>
  </entry>
  
</feed>
